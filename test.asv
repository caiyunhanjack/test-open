clear
%%%%%%%%%%%%%%%%%%%%%%%%
%%　参考　https://jp.mathworks.com/help/matlab/matlab_prog/access-data-in-a-table.html
%%%%%%%%%%%%%%%%%%%%%%%%


DOCID='1wG5fBaiQ7-jOzOI-2pkPAeV6SDiHc_LrOdcbWlvhHBw';
T=getTS6log(DOCID);% ログのテーブルを取得

 node='date';  % 検索する列の名前. T.Properties.VariableNamesで一覧表示できる
 pat=211224;   % 検索パターン（数値なら一致検索、文字なら含む検索）　

searchlog(T,node,pat)% ログのテーブルから当てはまるものを抽出した新しいテーブルを作成

%logからshot,TFshot,などのオペレーション設定を読む
prompt = 'number: ';
IDX=input(prompt) ;%表示したいショットのnumberの値（通し番号）を入力
date=T.date(IDX);
shot=T.shot(IDX);
TF_shot = T.TFoffset(IDX) ;
offset_TF = true;

%%ファイルへのパスを作る
%
pathname.ts3u=getenv('ts3u_path');
pathname.fourier='I:';%md0までのpath
pathname.NIFS=getenv('NIFS_path');%resultsまでのpath

filepath.mrd=strcat(pathname.ts3u, '\', string(date),'\' ...
    ,string(date),num2str(shot,'%03i'),'.mrd');
filepath.tfmrd=strcat(pathname.ts3u, '\', string(date),'\' ...
    ,string(date),num2str(TF_shot,'%03i'),'.mrd');
filepath.rgw=strcat(pathname.ts3u, '\', string(date),'\' ...
    ,string(date),num2str(shot,'%03i'),'.rgw');
filepath.D288=dir(strcat(pathname.fourier,'\Doppler\288CH\20',string(date),'\*shot',num2str(shot),'*.asc'));
filepath.Dhighspeed=dir(strcat(pathname.NIFS,'\Doppler\Photron\',string(date),'\**\*shot',num2str(shot),'*.tif'));
filepath.SXR=strcat(pathname.NIFS,'\X-ray\',string(date),'\shots\',string(date),num2str(shot,'%03i'),'.tif');





function output=searchlog(inputtable,node,pat)
%%名前,commentで検索(~を含むの検索)
if ischar(pat)
rows = contains( inputtable.(node),pat,'IgnoreCase',true); 
%%日付,shotなどで検索(一致検索)
else
 rows = inputtable.(node) == pat ;
end
output=inputtable(rows,:);
end

